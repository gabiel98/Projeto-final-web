<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="utf-8" />
		<title>Adicionar Usuário</title>
	</head>
	<body>
		<%- include('partials/header') %>
		<!-- Formulário para criar novo usuário -->
		<h1>Adicionar Usuário</h1>
		<form action="/users" method="POST">
			<% if (typeof csrfToken !== 'undefined' && csrfToken) { %>
				<input type="hidden" name="_csrf" value="<%= csrfToken %>" />
			<% } %>
			<div>
				<label for="nome">Nome do Usuário:</label>
				<input type="text" id="nome" name="nome_usuario" required />
			</div>

			<div>
				<label for="cargo">Cargo:</label>
				<input type="text" id="cargo" name="cargo_usuario" required />
			</div>

			<!-- Campos opcionais para autenticação -->
			<div>
				<label for="email">Email (obrigatório):</label>
				<input type="email" id="email" name="email_usuario" required />
			</div>
			<div>
				<label for="senha">Senha (obrigatório):</label>
				<input type="password" id="senha" name="senha_usuario" required />
			</div>

			<% if (typeof userRole !== 'undefined' && userRole === 'admin') { %>
				<div>
					<label for="role">Cargo:</label>
					<select id="role" name="role">
						<option value="customer" selected>Customer</option>
						<option value="manager">Manager</option>
						<option value="admin">Admin</option>
					</select>
				</div>
			<% } %>
			<% if (typeof query !== 'undefined') { %>
				<% if (query.erro === 'falta_email_ou_senha') { %>
					<p style="color: red">Preencha nome, email e senha.</p>
				<% } else if (query.erro === 'email_ja_cadastrado') { %>
					<p style="color: red">Este email já está cadastrado.</p>
				<% } %>
			<% } %>

			<button type="submit">Adicionar Usuário</button>
		</form>

		<p><a href="/users">Voltar para lista</a></p>
	</body>
</html>