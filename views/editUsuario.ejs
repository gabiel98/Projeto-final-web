<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Editar Usu치rio</title>
</head>

<body>
  <%- include('partials/header') %>
  <h1>Editar Usu치rio</h1>
  <form action="/users/<%= user._id %>/update" method="POST">
    <% if (typeof csrfToken !== 'undefined' && csrfToken) { %>
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
    <% } %>
    <div>
      <label>Nome:</label>
      <input type="text" name="nome_usuario" value="<%= user.nome %>" required>
    </div>
    <div>
      <label>Cargo (apenas para funcion치rios):</label>
      <select name="cargo_usuario">
        <option value="">Selecione (obrigat칩rio para funcion치rios)</option>
        <% (cargosPermitidos || []).forEach(function(c) { %>
          <option value="<%= c %>" <%= (user.cargo && user.cargo.toLowerCase() === c.toLowerCase()) ? 'selected' : '' %>><%= c %></option>
        <% }) %>
      </select>
    </div>
    <% if (typeof userRole !== 'undefined' && userRole === 'dono') { %>
    <div>
      <label>Permiss칚o:</label>
      <select name="role">
        <option value="comprador" <%= user.role === 'comprador' ? 'selected' : '' %>>Comprador</option>
        <option value="funcionario" <%= user.role === 'funcionario' ? 'selected' : '' %>>Funcion치rio</option>
        <option value="dono" <%= user.role === 'dono' ? 'selected' : '' %>>Dono</option>
      </select>
    </div>
    <% } %>
    <br>
    <% if (typeof query !== 'undefined' && query.erro === 'cargo_invalido') { %>
      <p style="color:red">Escolha um cargo v치lido para funcion치rios.</p>
    <% } %>
    <button type="submit">游 Salvar Altera칞칫es</button>
  </form>
  <br>
  <a href="/users">Cancelar</a>
</body>

</html>